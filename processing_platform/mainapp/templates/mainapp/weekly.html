<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex">

  <nav class="w-64 bg-white shadow p-6 flex flex-col">
    <h2 class="text-xl font-bold mb-4">Admin Panel</h2>
    <a href="{% url 'home' %}" class="block mb-2 text-blue-600 hover:underline">
      ← Back to Dashboard
    </a>
    <a href="{% url 'logout' %}" class="block text-red-600 hover:underline mt-auto">
      Log out
    </a>
  </nav>

  <main class="flex-1 p-8">

    <h1 class="text-2xl font-semibold mb-6">Manage Users</h1>

    <div class="overflow-x-auto mb-8">
      <table class="w-full table-auto border-collapse">
        <thead>
          <tr class="bg-gray-200">
            <th class="border p-2 text-left">Username</th>
            <th class="border p-2 text-left">Email</th>
            <th class="border p-2 text-left">Role</th>
            <th class="border p-2 text-left">Superuser</th>
          </tr>
        </thead>
        <tbody>
          {% for u in users %}
          <tr class="{% cycle 'bg-white' 'bg-gray-50' %}">
            <td class="border p-2">{{ u.username }}</td>
            <td class="border p-2">{{ u.email }}</td>
            <td class="border p-2">{{ u.role|default:"—" }}</td>
            <td class="border p-2">{{ u.is_superuser|yesno:"Yes,No" }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="border p-4 text-center text-gray-500">
              No users found.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="bg-white p-6 rounded shadow max-w-md mx-auto">
      <h2 class="text-xl font-semibold mb-4">Add New User</h2>

      {% if form.non_field_errors %}
      <div class="mb-4 p-3 bg-red-100 text-red-700 rounded">
        {{ form.non_field_errors }}
      </div>
      {% endif %}

      <form method="post" class="space-y-4">
        {% csrf_token %}

        <div>
          <label for="{{ form.username.id_for_label }}" class="block text-gray-700 mb-1">
            {{ form.username.label }}
          </label>
          {{ form.username }}
          {% for err in form.username.errors %}
          <p class="text-red-600 text-sm mt-1">{{ err }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="{{ form.email.id_for_label }}" class="block text-gray-700 mb-1">
            {{ form.email.label }}
          </label>
          {{ form.email }}
          {% for err in form.email.errors %}
          <p class="text-red-600 text-sm mt-1">{{ err }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="{{ form.role.id_for_label }}" class="block text-gray-700 mb-1">
            {{ form.role.label }}
          </label>
          {{ form.role }}
          {% for err in form.role.errors %}
          <p class="text-red-600 text-sm mt-1">{{ err }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="{{ form.password1.id_for_label }}" class="block text-gray-700 mb-1">
            {{ form.password1.label }}
          </label>
          {{ form.password1 }}
          {% for err in form.password1.errors %}
          <p class="text-red-600 text-sm mt-1">{{ err }}</p>
          {% endfor %}
        </div>

        <div>
          <label for="{{ form.password2.id_for_label }}" class="block text-gray-700 mb-1">
            {{ form.password2.label }}
          </label>
          {{ form.password2 }}
          {% for err in form.password2.errors %}
          <p class="text-red-600 text-sm mt-1">{{ err }}</p>
          {% endfor %}
        </div>

        <button
          type="submit"
          class="w-full bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition"
        >
          Create User
        </button>
      </form>
    </div>

  </main>
</body>
</html>
